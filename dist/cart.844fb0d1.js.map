{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,6DAMA,MAAMC,EAAcC,SAASC,eAAe,QACtCC,EAAeF,SAASC,eAAe,SAC7C,IAAIE,EAAO,GACPC,EAAQ,EAEZ,MAAMC,EAAkBL,SAASC,eAAe,eAGhD,SAASK,EAASC,GAEdA,EAAKC,SAAQC,KAwBjB,SAAuBA,GACnB,MAAMC,EAAcV,SAASW,cAAc,MAC3C,IAAIC,EAAS,EACbF,EAAYG,UAAY,UACxBH,EAAYI,UAAY,mEAeZL,EAAAM,OAAA,8DACaN,EAAKO,gHAGxBP,EAAAO,+BAAAJ,mGAGsBK,EAAOC,eAAcT,EAAAU,4BAGpBC,YAAeV,KACpCW,iBAAU,SAAAC,IACU,WAApBA,EAAAC,OAAQC,SAAY,oBAAAF,EAAAC,OAAAV,YACpBY,QAAQC,IAAC,cAhDrBC,eAA6BC,GACzB,MAAMC,EAAU1B,EAAK2B,QAAOrB,GAAWA,EAAQsB,KAAOH,IAEtDzB,EAAO0B,EAIPZ,EAAAe,iBAAiBH,GAEjB9B,EAAYe,UAAY,GAExBR,EAASuB,GAuCJI,CAAAxB,EAAAsB,KAGR,WAAAT,EAAAC,OAAAC,SAAA,iBAAAF,EAAAC,OAAAV,YAEDD,GAAA,EACMU,EAAAC,OAAcV,UAAG,UAAAJ,EAAAO,QAAAF,UAAAF,EACbZ,SAAOC,eAAA,UAAAQ,EAAeO,QAAMF,UAAMF,GAExB,WAAVU,EAAAC,OAAUC,SAAwB,cAAxBF,EAAAC,OAAAV,YACVD,GAAO,EACPa,QAAUC,IAAAd,GACVZ,SAAOC,eAAA,UAAAQ,EAAeO,QAAMF,UAAMF,MArEpCsB,CAAczB,GACdL,GAAS+B,SAAS1B,EAAQU,UAG9BjB,EAAakC,UAAYnB,EAAAC,eAAed,KAqE5BiB,iBAAA,UAAAM,MAAAL,6BAURe,EAAA,CACArB,KATAX,EAAIW,KAAAsB,MAUJC,SATAlC,EAAOkC,SAAAD,MAUVE,QATOnC,EAAAmC,QAAAF,MAYVG,OAXiBA,KAAAH,MAanBI,QAZKrC,EAAAqC,QAAAJ,MAaGK,KAXAtC,EAAYsC,KAAAL,MAYdM,YAXQvC,EAAAuC,YAAmBN,OAa3BO,kBACAC,EAAAC,mBAAOlD,EAAAmD,GAAAH,WAAAI,IAAA9C,EAAAC,EAAAiC,GACPlC,EAAA,GACDJ,EACUe,UAAA,GAKXR,EAASH,IAER+C,MAAA","sources":["scripts/cartPage.js"],"sourcesContent":["import { auth, db } from \"./app\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { getFirebaseCart, createFirebaseCart } from \"./cart\";\r\nimport { addProductToCart } from \"./utils\";\r\nimport { getMyLocalCart, currencyFormat } from \"./utils\";\r\n\r\nconst cartSection = document.getElementById(\"cart\");\r\nconst totalSection = document.getElementById(\"total\");\r\nlet cart = [];\r\nlet total = 0;\r\n\r\nconst paymentCartForm = document.getElementById(\"paymentForm\");\r\n\r\n\r\nfunction loadCart(cart) {\r\n    \r\n    cart.forEach(product => {\r\n        renderProduct(product);\r\n        total += parseInt(product.price);\r\n    });\r\n\r\n    totalSection.innerText = currencyFormat(total);\r\n};\r\n\r\nasync function removeProduct(productId) {\r\n    const newCart = cart.filter(product => product.id !== productId);\r\n    \r\n    cart = newCart;\r\n\r\n\r\n\r\n    addProductToCart(newCart);\r\n\r\n    cartSection.innerHTML = \"\";\r\n\r\n    loadCart(newCart);\r\n\r\n}\r\n\r\n\r\nfunction renderProduct(product) {\r\n    const productCart = document.createElement(\"li\");\r\n    let amount = 1;\r\n    productCart.className = \"product\";\r\n    productCart.innerHTML = `\r\n    <button class=\"product__delete\">X</button>\r\n    <img src=\"${product.images[0]}\" class=\"product__image\">\r\n    <h2 class=\"product__name\">${product.name}</h2>\r\n    <div class=\"counter\">\r\n        <button class=\"remove__item\"><</button>\r\n        <p id=\"amount_${product.name}\" class=\"counter__text\">${amount}</p>\r\n        <button class=\"add__item\">></button>\r\n    </div>\r\n    <h3 class=\"product__price\">${currencyFormat(product.price)}</h3>\r\n    \r\n    `;\r\n\r\n    cartSection.appendChild(productCart);\r\n\r\n    productCart.addEventListener(\"click\", e => {\r\n         if (e.target.tagName === \"BUTTON\" &&  e.target.className === \"product__delete\") {\r\n             console.log(\"remove it!\");\r\n             removeProduct(product.id);\r\n         }\r\n         if (e.target.tagName === \"BUTTON\" &&  e.target.className === \"remove__item\") {\r\n            amount-=1;\r\n            e.target.className(`amount_${product.name}`).innerHTML = amount;\r\n            document.getElementById(`amount_${product.name}`).innerHTML = amount\r\n        }\r\n        if (e.target.tagName === \"BUTTON\" &&  e.target.className === \"add__item\") {\r\n            amount+=1;\r\n            console.log(amount);\r\n            document.getElementById(`amount_${product.name}`).innerHTML = amount\r\n            \r\n        }\r\n\r\n    })\r\n};\r\n\r\npaymentCartForm.addEventListener('submit', async e =>{\r\n    e.preventDefault();\r\n    const name = paymentCartForm.name.value;\r\n    const lastname = paymentCartForm.lastname.value;\r\n    const country = paymentCartForm.country.value;\r\n    const town = paymentCartForm.town.value;\r\n    const address = paymentCartForm.address.value;\r\n    const card = paymentCartForm.card.value;\r\n    const card_number = paymentCartForm.card_number.value;\r\n    const userInfo = {\r\n        name,\r\n        lastname,\r\n        country,\r\n        town,\r\n        address,\r\n        card,\r\n        card_number,\r\n    }\r\n\r\n    if (userLogged) {\r\n        await createFirebaseCart(db, userLogged.uid, cart,total, userInfo);\r\n        cart = [];\r\n        cartSection.innerHTML = \"\";\r\n        loadCart(cart);\r\n    } else {\r\n        alert(\"inicia sesiÃ³n :(\")\r\n    }\r\n})\r\n\r\nonAuthStateChanged(auth, async (user) => {\r\n    if (user) {\r\n      // User is signed in, see docs for a list of available properties\r\n      // https://firebase.google.com/docs/reference/js/firebase.User\r\n      userLogged = user;\r\n      cart = getMyLocalCart();\r\n      //cart = await getFirebaseCart(db, userLogged.uid);\r\n    } else {\r\n        cart = getMyLocalCart();  \r\n      // User is signed out\r\n      // ...\r\n    }\r\n\r\n    loadCart(cart);\r\n\r\n  });"],"names":["$2mFfu","parcelRequire","$37372534b3b261c6$var$cartSection","document","getElementById","$37372534b3b261c6$var$totalSection","$37372534b3b261c6$var$cart","$37372534b3b261c6$var$total","$37372534b3b261c6$var$paymentCartForm","$37372534b3b261c6$var$loadCart","cart","forEach","product","productCart","createElement","amount","className","innerHTML","images","name","$7Jg0N","currencyFormat","price","appendChild","addEventListener","e","target","tagName","console","log","async","productId","newCart","filter","id","addProductToCart","$37372534b3b261c6$var$removeProduct","$37372534b3b261c6$var$renderProduct","parseInt","innerText","userInfo","value","lastname","country","town","address","card","card_number","userLogged","$1ZESu","createFirebaseCart","db","uid","alert"],"version":3,"file":"cart.844fb0d1.js.map"}